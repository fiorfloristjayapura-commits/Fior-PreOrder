<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Kartu Ucapan Valentine - Fior Florist</title>

<style>
* {margin:0;padding:0;box-sizing:border-box;}

:root {
  --gold-dark:#8f6e1d;
  --gold-main:#d4af37;
  --gold-light:#fff1b0;
  --gold-mid:#caa64b;
  --pink-text:#e8a5b5;
}

body {
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  padding:20px 15px;
  font-family:"Georgia","Times New Roman",serif;
  background:radial-gradient(ellipse at 30% 20%, #fff8e8, #f3e6c8 70%);
}

.page-title {
  font-size:24px;
  color:var(--gold-main);
  margin-bottom:20px;
  text-align:center;
  letter-spacing:2px;
  text-transform:uppercase;
}

.card-container {
  width:100%;
  max-width:340px;
}

.card {
  position:relative;
  width:100%;
  aspect-ratio:3/4;
  border-radius:24px;
  padding:12px;
  background:linear-gradient(145deg,var(--gold-dark),var(--gold-main),var(--gold-light),var(--gold-mid),var(--gold-dark));
  box-shadow:0 15px 40px rgba(0,0,0,0.25);
}

.card-inner {
  position:relative;
  width:100%;
  height:100%;
  border-radius:20px;
  overflow:hidden;
  background:#000;
}

.video-wrapper {
  position:relative;
  width:100%;
  height:58%;
}

.video-wrapper video {
  width:100%;
  height:100%;
  object-fit:cover;
}

.brand-logo {
  position:absolute;
  top:12px;
  right:12px;
  width:50px;
  height:50px;
  background:rgba(0,0,0,0.5);
  border-radius:50%;
  padding:6px;
}

.brand-logo img {
  width:100%;
  height:100%;
  object-fit:contain;
}

.content-area {
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  height:42%;
  padding:20px 16px 16px;
  background:linear-gradient(to bottom,transparent,rgba(0,0,0,0.9));
  display:flex;
  flex-direction:column;
  justify-content:flex-end;
  align-items:center;
  text-align:center;
}

.greeting-line {font-size:13px;color:#fff;}
.recipient-name {font-size:22px;color:var(--gold-light);font-weight:bold;}
.main-message {font-size:14px;color:var(--pink-text);margin-top:6px;}

.quote-text {
  font-size:12px;
  color:#fff;
  padding:8px 12px;
  border:1px solid var(--gold-main);
  border-radius:6px;
  background:rgba(0,0,0,0.4);
  opacity:0;
  margin-top:8px;
  transition:.4s;
}

.quote-text.visible {opacity:1;}

.lock-screen {
  position:absolute;
  inset:0;
  background:linear-gradient(145deg,#0a0a0a,#1f1f1f);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  z-index:10;
  cursor:pointer;
  transition:.5s;
}

.lock-screen.hidden {
  opacity:0;
  visibility:hidden;
  pointer-events:none;
}

.heart-icon {
  font-size:64px;
  animation:pulse 1.5s infinite;
}

@keyframes pulse {
  0%,100% {transform:scale(1);}
  50% {transform:scale(1.2);}
}

.tap-hint {
  font-size:13px;
  color:#fff;
  margin-top:12px;
}

.footer {
  margin-top:20px;
  font-size:11px;
  color:var(--gold-main);
  text-align:center;
}

.footer a {
  color:var(--gold-main);
  text-decoration:none;
}

.footer a:hover {
  text-decoration:underline;
}
</style>
</head>

<body>

<h1 class="page-title">Happy Valentine's Day</h1>

<div class="card-container">
<div class="card">
<div class="card-inner">

<div class="video-wrapper">
  <!-- TANPA AUTOPLAY -->
  <video id="mainVideo" loop playsinline preload="auto">
    <source src="https://raw.githubusercontent.com/fiorfloristjayapura-commits/Fior-PreOrder/83a0a2c28355c584011bf78ba3624116f3824635/aldo.mp4" type="video/mp4">
  </video>

  <div class="brand-logo">
    <img src="https://raw.githubusercontent.com/fiorfloristjayapura-commits/Fior-PreOrder/main/logo%20fior%20transparant.png">
  </div>
</div>

<div class="content-area">
  <p class="greeting-line">Untukmu,</p>
  <p class="recipient-name" id="recipientName">Nama Kamu</p>
  <p class="main-message" id="mainMessage">Happy Valentine's Day!</p>
  <p class="quote-text" id="quoteText"></p>
</div>

<div class="lock-screen" id="lockScreen">
  <div class="heart-icon">❤️</div>
  <p class="tap-hint">Sentuh untuk membuka</p>
</div>

</div>
</div>
</div>

<p class="footer">
  <a href="https://www.instagram.com/tokobungafior.jayapura?igsh=MWZqZHUyZjY1MnkyNw==" target="_blank">Fior Florist Jayapura</a> | 
  <a href="https://wa.me/6285337777585" target="_blank">WA: 085337777585</a>
</p>

<audio id="unlockSound" preload="auto">
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_c8c8a7d6c3.mp3" type="audio/mpeg">
</audio>

<script>
const video = document.getElementById('mainVideo');
const lockScreen = document.getElementById('lockScreen');
const unlockSound = document.getElementById('unlockSound');
const quoteText = document.getElementById('quoteText');
const recipientName = document.getElementById('recipientName');
const mainMessage = document.getElementById('mainMessage');

let unlocked = false;

/* ambil parameter */
const params = new URLSearchParams(window.location.search);
const nameParam = params.get('to');
const messageParam = params.get('msg');

if (nameParam) recipientName.textContent = nameParam;
if (messageParam) mainMessage.textContent = messageParam;

/* efek ketik */
function typeWriter(text, element, speed=50) {
  element.classList.add('visible');
  element.textContent = "";
  let i = 0;
  const timer = setInterval(() => {
    if (i < text.length) {
      element.textContent += text.charAt(i);
      i++;
    } else {
      clearInterval(timer);
    }
  }, speed);
}

function unlockCard() {
  if (unlocked) return;
  unlocked = true;

  // Pastikan video dimuat sebelum play
  if (video.readyState >= 2) { // HAVE_CURRENT_DATA or higher
    playVideoWithSound();
  } else {
    console.log("Video belum siap, menunggu load.");
    video.addEventListener('canplay', playVideoWithSound, { once: true });
  }

  try {
    unlockSound.currentTime = 0;
    unlockSound.play().catch((e) => {
      console.log("Audio play gagal:", e);
    });
  } catch (e) {
    console.log("Error saat play audio:", e);
  }

  lockScreen.classList.add('hidden');

  setTimeout(() => {
    typeWriter('Simply put, I love you more each day', quoteText);
  }, 400);
}

function playVideoWithSound() {
  try {
    video.muted = false;
    video.volume = 1; // Pastikan volume penuh
    video.currentTime = 0;
    video.play().then(() => {
      console.log("Video berhasil dimainkan dengan suara.");
      // Jika masih tidak ada suara, coba unmute lagi setelah play
      setTimeout(() => {
        video.muted = false;
        video.volume = 1;
        console.log("Unmute ulang setelah play.");
      }, 100);
    }).catch((e) => {
      console.log("Video play gagal:", e);
      // Fallback: play muted, lalu coba unmute
      video.muted = true;
      video.play().then(() => {
        console.log("Video dimainkan muted, mencoba unmute.");
        setTimeout(() => {
          video.muted = false;
          video.volume = 1;
          console.log("Unmute setelah fallback.");
        }, 500);
      }).catch((e2) => {
        console.log("Fallback juga gagal:", e2);
      });
    });
  } catch (e) {
    console.log("Error saat play video:", e);
  }
}

// Tambahkan event listener global untuk interaksi jika diperlukan
document.addEventListener('click', () => {
  if (unlocked && video.muted) {
    video.muted = false;
    video.volume = 1;
    console.log("Unmute via global click.");
  }
}, { once: false });

lockScreen.addEventListener('click', unlockCard);
lockScreen.addEventListener('touchstart', unlockCard, {passive:true});
</script>

</body>
</html>

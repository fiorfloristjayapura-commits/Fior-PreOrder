// Ganti fetch dengan CORS mode
fetch(scriptURL, {
  mode: 'no-cors' // Atau gunakan proxy jika masih error
})
  .then(res => res.json())
  .then(data => {
    // ... kode sebelumnya ...
  })
  .catch(error => {
    console.error("Fetch error:", error);
    // Fallback: coba dengan method berbeda
    fetchWithRetry(scriptURL);
  });

// Fungsi fallback jika ada CORS issues
function fetchWithRetry(url, retries = 3) {
  return fetch(url)
    .catch(err => {
      if (retries > 0) {
        console.log(`Retrying... ${retries} attempts left`);
        return new Promise(resolve => 
          setTimeout(() => resolve(fetchWithRetry(url, retries - 1)), 1000)
        );
      }
      throw err;
    });
}

// Atau gunakan JSONP untuk bypass CORS di doGet
function loadCustomers() {
  // Buat script element untuk JSONP
  const script = document.createElement('script');
  script.src = scriptURL + '?callback=handleCustomers';
  document.head.appendChild(script);
}

function handleCustomers(data) {
  const select = document.getElementById("customer");
  select.innerHTML = "<option value=''>Pilih customer</option>";
  
  data.forEach(customer => {
    const option = document.createElement("option");
    option.value = JSON.stringify(customer);
    option.textContent = customer.nama;
    select.appendChild(option);
  });
}
